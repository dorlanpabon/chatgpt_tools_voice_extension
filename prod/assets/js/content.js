(()=>{let e=localStorage.getItem("speech_automatic")||"Progresivo",t=localStorage.getItem("speech_voice")||"Google espaÃ±ol de Estados Unidos",n=localStorage.getItem("speech_lang")||"es-ES",o=localStorage.getItem("speech_rate")||"1",l=localStorage.getItem("speech_pitch")||"1";const c=["flex","py-3","px-3","items-center","gap-3","rounded-md","hover:bg-gray-500/10","transition-colors","duration-200","text-white","cursor-pointer","text-sm"];let i=document.querySelector("nav");const a=document.createElement("a");a.id="stop-voice",a.textContent="Stop Voice",a.classList.add(...c),a.addEventListener("click",(()=>{"speechSynthesis"in window&&speechSynthesis.cancel()})),a.innerHTML='<svg fill="#ffffff" height="1.2rem" width="1.2rem"" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 300.003 300.003" xml:space="preserve"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <path d="M150.001,0c-82.838,0-150,67.159-150,150c0,82.838,67.162,150.003,150,150.003c82.843,0,150-67.165,150-150.003 C300.001,67.159,232.846,0,150.001,0z M134.41,194.538c0,9.498-7.7,17.198-17.198,17.198s-17.198-7.7-17.198-17.198V105.46 c0-9.498,7.7-17.198,17.198-17.198s17.198,7.7,17.198,17.198V194.538z M198.955,194.538c0,9.498-7.701,17.198-17.198,17.198 c-9.498,0-17.198-7.7-17.198-17.198V105.46c0-9.498,7.7-17.198,17.198-17.198s17.198,7.7,17.198,17.198V194.538z"></path> </g> </g> </g></svg>  Stop Voice ',i.appendChild(a);const r=document.createElement("select");r.id="select-read",r.classList.add(...c),r.addEventListener("change",(t=>{e=t.target.value,localStorage.setItem("speech_automatic",e)})),r.value=e,r.style.color="black",r.style.display="none";["Progresivo","Frase","Desactivado"].forEach((t=>{const n=document.createElement("option");n.textContent=t,n.value=t,t==e&&(n.selected=!0),r.appendChild(n)})),i.appendChild(r);const s=document.createElement("select");s.id="select-voice",s.classList.add(...c),s.addEventListener("change",(e=>{t=e.target.value,localStorage.setItem("speech_voice",t),n=e.target.options[e.target.selectedIndex].getAttribute("data-voice-lang"),localStorage.setItem("speech_lang",n)})),s.value=t,s.style.color="black",s.style.display="none",speechSynthesis.getVoices(),chargeVoices=()=>{voices=speechSynthesis.getVoices().sort((function(e,t){const n=e.name.toUpperCase(),o=t.name.toUpperCase();return n<o?-1:n==o?0:1})),voices.forEach((e=>{console.log(e.name);const n=document.createElement("option");n.textContent=e.name,n.value=e.name,n.setAttribute("data-voice-lang",e.lang),e.name==t&&(n.selected=!0),s.appendChild(n)}))},setTimeout(chargeVoices,1e3),i.appendChild(s);const d=document.createElement("div");d.id="div-voice",d.classList.add(...c),d.style.display="none",i.appendChild(d);const p=document.createElement("input");p.id="rate-voice",p.addEventListener("change",(e=>{o=e.target.value,localStorage.setItem("speech_rate",o),u.innerHTML="Rate: "+o})),p.value=o,p.type="range",p.min="0.5",p.max="2",p.step="0.1",p.value=o,p.style.color="black";const g=document.createElement("div");g.id="div-rate-voice",g.classList.add(...c),g.style.display="none",d.appendChild(g);const u=document.createElement("label");u.id="label-rate-voice",u.textContent="Rate: "+o,u.setAttribute("for","rate-voice"),g.appendChild(u),g.appendChild(p);const h=document.createElement("input");h.id="pitch-voice",h.addEventListener("change",(e=>{l=e.target.value,localStorage.setItem("speech_pitch",l),v.innerHTML="Pitch: "+l})),h.value=l,h.type="range",h.min="0",h.max="2",h.step="0.1",h.value=l,h.style.color="black";const m=document.createElement("div");m.id="div-pitch-voice",m.classList.add(...c),m.style.display="none",d.appendChild(m);const v=document.createElement("label");v.id="label-pitch-voice",v.textContent="Pitch: "+l,v.setAttribute("for","pitch-voice"),m.appendChild(v),m.appendChild(h),i.appendChild(m);const y=document.createElement("a");y.id="settings-voice",y.textContent="Settings",y.classList.add(...c),y.addEventListener("click",(()=>{"none"==r.style.display?(r.style.display="block",s.style.display="block",m.style.display="flex",g.style.display="flex"):(r.style.display="none",s.style.display="none",m.style.display="none",g.style.display="none")})),i.appendChild(y);let C=["stop-voice","select-read","select-voice","div-rate-voice","div-pitch-voice","settings-voice"];function f(){let e=new Date;return`${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}`}function x(e){if("speechSynthesis"in window){const n=new SpeechSynthesisUtterance(e);for(let e=0;e<voices.length;e++)if(voices[e].name==t){n.voice=voices[e],n.lang=voices[e].lang;break}n.rate=o,n.pitch=l,n.onend=e=>{console.log("onend"),console.log(e)},n.onmark=e=>{console.log("onmark"),console.log(e)},n.onpause=e=>{console.log("onpause"),console.log(e)},n.onerror=e=>{console.log("onerror"),console.log(e)},n.onresume=e=>{console.log("onresume"),console.log(e)},n.onstart=e=>{console.log("onstart"),console.log(e)},n.onboundary=e=>{console.log("onboundary"),console.log(e.name)},console.log("mensaje",n),speechSynthesis.speak(n)}else console.log("Lo siento, tu navegador no admite la API de Web Speech")}setInterval((function(){C.forEach((e=>{null==document.getElementById(e)&&(i=document.querySelector("nav"),"stop-voice"==e?i.appendChild(a):"select-read"==e?i.appendChild(r):"select-voice"==e?i.appendChild(s):"settings-voice"==e?i.appendChild(y):"div-rate-voice"==e?i.appendChild(g):"div-pitch-voice"==e&&i.appendChild(m))})),document.querySelectorAll(".flex-col.relative.items-end:not(.button-added)").forEach((function(e){let t=document.createElement("button"),n=document.createElement("button");document.createElement("button");t.innerHTML='<svg height="1.5em" width="1.5em"  viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path fill-rule="evenodd" clip-rule="evenodd" d="M12.1657 2.14424C12.8728 2.50021 13 3.27314 13 3.7446V20.2561C13 20.7286 12.8717 21.4998 12.1656 21.8554C11.416 22.2331 10.7175 21.8081 10.3623 21.4891L4.95001 16.6248H3.00001C1.89544 16.6248 1.00001 15.7293 1.00001 14.6248L1 9.43717C1 8.3326 1.89543 7.43717 3 7.43717H4.94661L10.3623 2.51158C10.7163 2.19354 11.4151 1.76635 12.1657 2.14424ZM11 4.63507L6.00618 9.17696C5.82209 9.34439 5.58219 9.43717 5.33334 9.43717H3L3.00001 14.6248H5.33334C5.58015 14.6248 5.81823 14.716 6.00179 14.881L11 19.3731V4.63507Z" fill="#acacbe"></path> <path d="M16.0368 4.73124C16.1852 4.19927 16.7368 3.88837 17.2688 4.03681C20.6116 4.9696 23 8.22106 23 12C23 15.779 20.6116 19.0304 17.2688 19.9632C16.7368 20.1117 16.1852 19.8007 16.0368 19.2688C15.8884 18.7368 16.1993 18.1852 16.7312 18.0368C19.1391 17.3649 21 14.9567 21 12C21 9.04332 19.1391 6.63512 16.7312 5.96321C16.1993 5.81477 15.8884 5.2632 16.0368 4.73124Z" fill="#acacbe"></path> <path d="M16.2865 8.04192C15.7573 7.88372 15.2001 8.18443 15.0419 8.71357C14.8837 9.24271 15.1844 9.79992 15.7136 9.95812C16.3702 10.1544 17 10.9209 17 12C17 13.0791 16.3702 13.8456 15.7136 14.0419C15.1844 14.2001 14.8837 14.7573 15.0419 15.2865C15.2001 15.8156 15.7573 16.1163 16.2865 15.9581C17.9301 15.4667 19 13.8076 19 12C19 10.1924 17.9301 8.53333 16.2865 8.04192Z" fill="#acacbe"></path> </g></svg>',t.style.cssText="margin-right: 10px; margin-left: 10px;",t.onclick=function(){console.log("speech:",e.parentElement.innerText);let t=e.parentElement?.innerHTML.replace(/<pre>[\s\S]*?<\/pre>/g,""),n=document.createElement("div");n.innerHTML=t;let o=n.textContent||n.innerText||"",l=0;if(separador=/([.,])/,textSplit=o?.match(/.+?[.,]|.+/g),textSplitLength=textSplit.length,condicion=l<textSplitLength,condicion){for(let e=l;e<textSplitLength;e++)l++,x(textSplit[e])}},n.innerHTML='<svg fill="#acacbe" height="1.5em" width="1.5em"  version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 64 64" enable-background="new 0 0 64 64" xml:space="preserve" stroke="#acacbe" transform="matrix(-1, 0, 0, 1, 0, 0)rotate(0)"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g id="Text-files"> <path d="M53.9791489,9.1429005H50.010849c-0.0826988,0-0.1562004,0.0283995-0.2331009,0.0469999V5.0228 C49.7777481,2.253,47.4731483,0,44.6398468,0h-34.422596C7.3839517,0,5.0793519,2.253,5.0793519,5.0228v46.8432999 c0,2.7697983,2.3045998,5.0228004,5.1378999,5.0228004h6.0367002v2.2678986C16.253952,61.8274002,18.4702511,64,21.1954517,64 h32.783699c2.7252007,0,4.9414978-2.1725998,4.9414978-4.8432007V13.9861002 C58.9206467,11.3155003,56.7043495,9.1429005,53.9791489,9.1429005z M7.1110516,51.8661003V5.0228 c0-1.6487999,1.3938999-2.9909999,3.1062002-2.9909999h34.422596c1.7123032,0,3.1062012,1.3422,3.1062012,2.9909999v46.8432999 c0,1.6487999-1.393898,2.9911003-3.1062012,2.9911003h-34.422596C8.5049515,54.8572006,7.1110516,53.5149002,7.1110516,51.8661003z M56.8888474,59.1567993c0,1.550602-1.3055,2.8115005-2.9096985,2.8115005h-32.783699 c-1.6042004,0-2.9097996-1.2608986-2.9097996-2.8115005v-2.2678986h26.3541946 c2.8333015,0,5.1379013-2.2530022,5.1379013-5.0228004V11.1275997c0.0769005,0.0186005,0.1504021,0.0469999,0.2331009,0.0469999 h3.9682999c1.6041985,0,2.9096985,1.2609005,2.9096985,2.8115005V59.1567993z"></path> <path d="M38.6031494,13.2063999H16.253952c-0.5615005,0-1.0159006,0.4542999-1.0159006,1.0158005 c0,0.5615997,0.4544001,1.0158997,1.0159006,1.0158997h22.3491974c0.5615005,0,1.0158997-0.4542999,1.0158997-1.0158997 C39.6190491,13.6606998,39.16465,13.2063999,38.6031494,13.2063999z"></path> <path d="M38.6031494,21.3334007H16.253952c-0.5615005,0-1.0159006,0.4542999-1.0159006,1.0157986 c0,0.5615005,0.4544001,1.0159016,1.0159006,1.0159016h22.3491974c0.5615005,0,1.0158997-0.454401,1.0158997-1.0159016 C39.6190491,21.7877007,39.16465,21.3334007,38.6031494,21.3334007z"></path> <path d="M38.6031494,29.4603004H16.253952c-0.5615005,0-1.0159006,0.4543991-1.0159006,1.0158997 s0.4544001,1.0158997,1.0159006,1.0158997h22.3491974c0.5615005,0,1.0158997-0.4543991,1.0158997-1.0158997 S39.16465,29.4603004,38.6031494,29.4603004z"></path> <path d="M28.4444485,37.5872993H16.253952c-0.5615005,0-1.0159006,0.4543991-1.0159006,1.0158997 s0.4544001,1.0158997,1.0159006,1.0158997h12.1904964c0.5615025,0,1.0158005-0.4543991,1.0158005-1.0158997 S29.0059509,37.5872993,28.4444485,37.5872993z"></path> </g> </g></svg>',n.style.cssText="margin-right: 10px;",n.onclick=function(){console.log("copy to clipboard",e.innerText);const t=e.parentElement.innerText,n=document.createElement("input");document.body.appendChild(n),n.value=t,n.select(),document.execCommand("copy"),document.body.removeChild(n)},e?.append(t),e?.append(n),console.log(e),e.classList.add("button-added")}));let t=document.querySelectorAll("form button:not(.button-send):not(.justify-center)"),n=Array.from(t).find((e=>""==e.innerText)),o=document.querySelector("form div div textarea:not(.textarea-enter)");const l=()=>{if(console.log(f(),"button send"),"Desactivado"==e)return void n?.removeEventListener("click",l);console.log("Antes de validar textArea",e);let t=""==document.querySelector("form textarea").value;console.log("text",t);let o="."!=document.querySelector("form button:not(.justify-center)")?.innerText;console.log("validateProgress",o);let c=document.querySelectorAll(".flex-col.relative.items-end.button-added")?.length;console.log("countElements",c);let i=document.querySelector("form button:not(.button-send).justify-center")?.innerText.includes("Stop")||!1;console.log("buttonStopExist",i);let a=document.querySelector("form button:not(.button-send).justify-center")?.innerText.includes("Regenerate")||!1;if(console.log("buttonRegenerateExist",a),t||!t&&!o||i)return;console.log("Despues de validar textArea",e);let r=!1,s=0,d=setInterval((()=>{let t=""!=document.querySelector("form button:not(.justify-center)")?.innerText;if(!r){if(buttonStopElement=null!=document.querySelector("form button svg rect"),!buttonStopElement)return;return r=!0,void console.log(f(),"button stop",r)}let n=document.querySelectorAll("div.flex.flex-col.items-center div.w-full.border-b"),o=n[n.length-1]?.innerHTML.replace(/<pre>[\s\S]*?<\/pre>/g,""),l=document.createElement("div");l.innerHTML=o;let c,i,a=l.textContent||l.innerText||"";if(a.includes("Try again later."))return void clearInterval(d);let p,g,u=!1;switch(e){case"Progresivo":c=" ",g=a?.split(c),p=g.length-1,i=s<p&&s+10<p;break;case"Frase":c=/([.,])/,g=a?.match(/.+?[.,]|.+/g),p=g.length-1,i=s<p;break;case"Completo":u=!0}if(t){if(u)return;if(i){let e="";for(let t=s;t<p;t++)e+=g[t],s++;x(e)}}else{if(u)return x(a),void clearInterval(d);if(s<g.length){let e="";for(let t=s;t<g.length;t++)e+=g[t],s++;x(e)}clearInterval(d)}}),1e3);n?.removeEventListener("click",l)};handleKeydown=e=>{"Enter"==e.key&&l()},n?.classList?.add("button-send"),o?.classList?.add("textarea-enter"),n?.removeEventListener("click",l),o?.removeEventListener("keydown",handleKeydown),n?.addEventListener("click",l),o?.addEventListener("keydown",handleKeydown)}),1e3)})();